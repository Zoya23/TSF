# Code Generated by Sidekick is for learning and experimentation purposes only.
# Step 1: Loading Dataset and pre-processing
path = r'C:\Users\Desktop\DataScience\Sem 2\Time_Series_Analysis\Practical\Symphony-Data.csv'

import pandas as pd
import matplotlib.pyplot as plt

df = pd.read_csv(path)
df = df.drop(['OPEN', 'HIGH', 'LOW', 'VOLUME', 'CHANGE(%)'], axis=1)
df['DATE'] = pd.to_datetime(df['DATE'], format='%d-%b-%y')
df = df.sort_values(by='DATE', ascending=True)

# Step 2: Calculate the 30 days (1 month) moving average
df['Moving-Avg'] = df['PRICE'].rolling(window=30).mean()

# Step 3: Calculate the trend (rate of change)
df['Trend'] = df['Moving-Avg'].diff()

# Step 4: Calculate the seasonal variation
df['Seasonal_Variation'] = df['PRICE'] - df['Moving-Avg']

# Visualizing Raw Data and Moving Average Data
plt.plot(df['DATE'], df['PRICE'], label='Raw Data')
plt.plot(df['DATE'], df['Moving-Avg'], label='Moving Avg. Data')
plt.legend()
plt.xlabel('Year')
plt.ylabel('Stock Price(Rs.)')
plt.title('Stock Closing Price Data')
plt.show()

# Visualizing Trend and Seasonal Variation
plt.plot(df['DATE'], df['Trend'], label='Trend')
plt.plot(df['DATE'], df['Seasonal_Variation'], label='Seasonal Variation')
plt.legend()
plt.xlabel('Year')
plt.ylabel('Stock Price(Rs.)')
plt.title('Stock Closing Price Data')
plt.show()
